{
  "version": 3,
  "sources": ["../background.js"],
  "sourcesContent": ["/* global chrome */\n\n// --- CONFIGURATION ---\n// These values are injected by the build script (build.sh) as a global CONFIG object.\nconsole.log('[Background] Starting in PRODUCTION mode');\n\n// Define CONFIG object if not injected by build script\nif (typeof CONFIG === 'undefined') {\n  globalThis.CONFIG = {\n    AUTH_ENDPOINT: 'https://70h4jbuv95.execute-api.us-east-2.amazonaws.com/prod/email-poller'\n  };\n}\n\n// Get AUTH_ENDPOINT from CONFIG (injected by build script)\nconst AUTH_ENDPOINT = CONFIG?.AUTH_ENDPOINT || 'https://70h4jbuv95.execute-api.us-east-2.amazonaws.com/prod/email-poller';\n\n// Map to track Web OAuth flows by tab ID\nconst webOAuthFlows = new Map();\n\n// Helper function to get redirect URL that works in both Chrome and Edge\nfunction getRedirectURL() {\n  // For Edge compatibility, use the hardcoded URL if getRedirectURL is not available\n  const redirectUri = chrome.identity.getRedirectURL \n    ? chrome.identity.getRedirectURL()\n    : \"https://70h4jbuv95.execute-api.us-east-2.amazonaws.com/prod/email-poller/oauth2-callback\";\n  \n  console.log('[Background] Using redirect URI:', redirectUri);\n  return redirectUri;\n}\n\n\n\nchrome.runtime.onMessage.addListener((message, sender, sendResponse) => {\n  console.log('[Background] Received message:', message.type);\n  console.log('[Background] Message details:', { type: message.type, sender: sender.tab?.url || 'no-tab' });\n\n  // --- Message Handler: Unified File Fetching (CORS bypass) ---\n  if (message.type === 'fetchFileForPreview' && message.url) {\n    console.log('[Background] Fetching file for preview:', message.url);\n    \n    fetch(message.url, {\n      method: 'GET',\n      headers: {\n        'Accept': 'application/pdf, image/*, */*',\n        'Accept-Encoding': 'gzip, deflate, br',\n        'Accept-Language': 'en-US,en;q=0.9',\n        'Cache-Control': 'no-cache',\n        'Pragma': 'no-cache',\n        'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36',\n        'Sec-Fetch-Dest': 'document',\n        'Sec-Fetch-Mode': 'navigate',\n        'Sec-Fetch-Site': 'cross-site',\n        'Sec-Fetch-User': '?1',\n        'Upgrade-Insecure-Requests': '1'\n      }\n    })\n      .then(response => {\n        console.log('[Background] Fetch response status:', response.status);\n        console.log('[Background] Fetch response headers:', Object.fromEntries(response.headers.entries()));\n        \n        if (!response.ok) {\n          throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n        }\n        \n        // Log content type and size\n        const contentType = response.headers.get('content-type');\n        const contentLength = response.headers.get('content-length');\n        console.log('[Background] File details:', {\n          contentType,\n          contentLength: contentLength ? `${Math.round(contentLength / 1024)}KB` : 'unknown'\n        });\n        \n        return response.blob();\n      })\n      .then(blob => {\n        console.log('[Background] Blob created:', {\n          type: blob.type,\n          size: blob.size,\n          sizeKB: Math.round(blob.size / 1024)\n        });\n        \n        // Convert blob to data URL\n        const reader = new FileReader();\n        reader.onload = () => {\n          console.log('[Background] File converted to data URL successfully');\n          sendResponse({ \n            success: true, \n            dataUrl: reader.result,\n            mimeType: blob.type,\n            fileSize: blob.size,\n            originalUrl: message.url\n          });\n        };\n        reader.onerror = () => {\n          console.error('[Background] Failed to convert file to data URL');\n          sendResponse({ success: false, error: 'Failed to convert file to data URL' });\n        };\n        reader.readAsDataURL(blob);\n      })\n      .catch(error => {\n        console.error('[Background] Failed to fetch file:', error);\n        sendResponse({ success: false, error: error.message });\n      });\n    \n    return true; // Keep message channel open for async response\n  }\n\n  // --- Message Handler 1: InboxSDK Page World Injection ---\n  if (message.type === 'inboxsdk__injectPageWorld' && sender.tab) {\n    const promise = new Promise((resolve) => {\n      console.log('[Background] Handling InboxSDK page world injection');\n      if (chrome.scripting) {\n        const target = { tabId: sender.tab.id, frameIds: [sender.frameId] };\n        chrome.scripting.executeScript({\n          target: target,\n          world: 'MAIN',\n          files: ['pageWorld.js'],\n        }, () => resolve(true));\n      } else {\n        resolve(false);\n      }\n    });\n    promise.then(sendResponse);\n    return true;\n  }\n\n  // --- Message Handler 2: Get Authentication Code ---\n  if (message.type === 'GET_AUTH_CODE') {\n    const promise = new Promise((resolve, reject) => {\n      console.log('[Background] Starting GET_AUTH_CODE flow using launchWebAuthFlow.');\n\n      const manifest = chrome.runtime.getManifest();\n      const clientId = manifest.oauth2.client_id;\n      const scopes = manifest.oauth2.scopes.join(' ');\n      const redirectUri = getRedirectURL();\n\n      console.log('[Background] Chrome Extension OAuth flow parameters:', { \n        clientId, \n        redirectUri, \n        scopes: manifest.oauth2.scopes \n      });\n      console.log('[Background] \uD83D\uDD0D CHROME EXTENSION CLIENT ID:', clientId);\n\n      const authUrl = `https://accounts.google.com/o/oauth2/v2/auth?` +\n        `client_id=${clientId}&` +\n        `response_type=code&` +\n        `access_type=online&` + // Changed to online for Chrome extension\n        `prompt=consent&` +      \n        `scope=${encodeURIComponent(scopes)}&` +\n        `redirect_uri=${encodeURIComponent(redirectUri)}`;\n\n      console.log('[Background] Generated Chrome Extension auth URL:', authUrl);\n\n      try {\n        console.log('[Background] \uD83D\uDE80 Launching Chrome Extension OAuth flow...');\n        console.log('[Background] \uD83D\uDD0D OAuth will prompt user to sign in with their Google account');\n        chrome.identity.launchWebAuthFlow({ url: authUrl, interactive: true }, (responseUrl) => {\n          if (chrome.runtime.lastError) {\n            console.error('[Background] \u274C Chrome Extension OAuth flow error:', chrome.runtime.lastError.message);\n            console.error('[Background] \uD83D\uDD0D Error details:', {\n              error: chrome.runtime.lastError.message,\n              clientId: clientId,\n              redirectUri: redirectUri,\n              authUrl: authUrl\n            });\n            reject(new Error(chrome.runtime.lastError.message));\n            return;\n          }\n\n          if (responseUrl) {\n            console.log('[Background] Received response URL:', responseUrl);\n            const code = new URL(responseUrl).searchParams.get('code');\n            resolve({ code: code, redirectUri: redirectUri });\n          } else {\n            console.log('[Background] Auth flow cancelled by user.');\n            reject(new Error('Auth flow cancelled by user.'));\n          }\n        });\n      } catch (error) {\n        console.error('[Background] Error in launchWebAuthFlow:', error);\n        reject(error);\n      }\n    });\n\n    promise.then(sendResponse).catch(error => sendResponse({ error: error.message }));\n    return true; // Indicates an async response\n  }\n\n\n\n  // --- Message Handler 3: Start Web Client OAuth Flow ---\n  if (message.type === 'START_WEB_OAUTH_FLOW') {\n    const promise = new Promise((resolve, reject) => {\n      console.log('[Background] Starting Web OAuth flow');\n      console.log('[Background] \uD83C\uDF10 WEB OAUTH ENDPOINT:', AUTH_ENDPOINT);\n      console.log('[Background] \uD83D\uDCDD Note: Web OAuth client ID will be determined by backend server');\n\n      // Use the full AUTH_ENDPOINT path since backend endpoints are at /email-poller/auth/...\n      const oauthStartUrl = `${AUTH_ENDPOINT}/auth/google/start`;\n      console.log('[Background] Opening Web OAuth tab:', oauthStartUrl);\n      console.log('[Background] \uD83D\uDD0D Expected OAuth flow:');\n      console.log('[Background]   1. Backend OAuth start \u2192 Google OAuth \u2192 Backend callback');\n      console.log('[Background]   2. Backend should show success page with user email');\n      console.log('[Background]   3. OAuth callback detector should detect success on backend page');\n\n      // Create a new tab for the Web OAuth flow\n      console.log('[Background] \uD83D\uDE80 Creating Web OAuth tab...');\n      console.log('[Background] \uD83D\uDCCB OAuth tab will open:', oauthStartUrl);\n      chrome.tabs.create({\n        url: oauthStartUrl,\n        active: true\n      }, (tab) => {\n        if (chrome.runtime.lastError) {\n          console.error('[Background] \u274C Error creating Web OAuth tab:', chrome.runtime.lastError.message);\n          console.error('[Background] \uD83D\uDD0D Web OAuth error details:', {\n            error: chrome.runtime.lastError.message,\n            oauthStartUrl: oauthStartUrl,\n            authEndpoint: AUTH_ENDPOINT\n          });\n          reject(new Error(chrome.runtime.lastError.message));\n          return;\n        }\n\n        console.log('[Background] OAuth tab created, ID:', tab.id);\n\n        // Set up timeout for OAuth flow\n        const timeout = setTimeout(() => {\n          console.log('[Background] OAuth flow timed out');\n          webOAuthFlows.delete(tab.id);\n          chrome.tabs.remove(tab.id).catch(() => {});\n          reject(new Error('Web OAuth flow timed out'));\n        }, 5 * 60 * 1000); // 5 minute timeout\n\n        // Store the flow state\n        webOAuthFlows.set(tab.id, { resolve, reject, timeout });\n        \n        // Listen for tab updates to see where the OAuth flow goes\n        const tabUpdateListener = (tabId, changeInfo, updatedTab) => {\n          if (tabId === tab.id && changeInfo.url) {\n            console.log('[Background] OAuth tab navigated to:', changeInfo.url);\n            if (changeInfo.url.includes('70h4jbuv95.execute-api.us-east-2.amazonaws.com/prod/email-poller/oauth2-callback')) {\n              console.log('[Background] \uD83C\uDFAF OAuth callback page detected!');\n            }\n            if (changeInfo.url.includes('70h4jbuv95.execute-api.us-east-2.amazonaws.com')) {\n              console.log('[Background] \uD83C\uDFAF Backend OAuth page detected!');\n            }\n            if (changeInfo.url.includes('accounts.google.com')) {\n              console.log('[Background] \uD83C\uDFAF Google OAuth page detected!');\n            }\n          }\n        };\n        \n        chrome.tabs.onUpdated.addListener(tabUpdateListener);\n        \n        // Store the listener so we can remove it later\n        webOAuthFlows.get(tab.id).tabUpdateListener = tabUpdateListener;\n        \n        console.log('[Background] Waiting for OAuth completion...');\n      });\n    });\n\n    promise.then(result => {\n      console.log('[Background] Web OAuth completed successfully');\n      sendResponse(result);\n    }).catch(error => {\n      console.error('[Background] Web OAuth failed:', error.message);\n      sendResponse({ error: error.message });\n    });\n    return true; // Indicates an async response\n  }\n\n  // --- Message Handler 4: OAuth Web Client Complete ---\n  if (message.type === 'OAUTH_WEB_CLIENT_COMPLETE') {\n    console.log('[Background] Received OAuth completion:', message.result.success ? 'SUCCESS' : 'FAILED');\n    console.log('[Background] OAuth result details:', {\n      success: message.result.success,\n      userEmail: message.result.userEmail,\n      method: message.result.method,\n      error: message.result.error,\n      url: message.url\n    });\n\n    // Find the tab that sent this message\n    if (sender.tab) {\n      const tabId = sender.tab.id;\n      const flowState = webOAuthFlows.get(tabId);\n\n      if (flowState) {\n        console.log('[Background] Found matching OAuth flow, cleaning up...');\n\n        // Clear the timeout\n        clearTimeout(flowState.timeout);\n        \n        // Remove tab update listener\n        if (flowState.tabUpdateListener) {\n          chrome.tabs.onUpdated.removeListener(flowState.tabUpdateListener);\n        }\n        \n        webOAuthFlows.delete(tabId);\n\n        // Close the OAuth tab\n        chrome.tabs.remove(tabId).catch(() => {});\n\n        // Resolve or reject based on the result\n        if (message.result.success) {\n          console.log('[Background] OAuth flow completed successfully');\n          \n          // Store user email if available\n          if (message.result.userEmail) {\n            console.log('[Background] Storing user email:', message.result.userEmail);\n            chrome.storage.local.set({ userEmail: message.result.userEmail });\n          } else {\n            console.warn('[Background] No user email found in OAuth result');\n          }\n          \n          flowState.resolve({\n            success: true,\n            url: message.url,\n            result: message.result\n          });\n        } else {\n          console.error('[Background] OAuth flow failed:', message.result.error);\n          flowState.reject(new Error(message.result.error || 'Web OAuth flow failed'));\n        }\n      } else {\n        console.warn('[Background] No matching OAuth flow found for tab:', tabId);\n      }\n    }\n\n    sendResponse({ received: true });\n    return false;\n  }\n\n  // --- Message Handler 5: Get Chrome Extension Access Token ---\n  if (message.type === 'GET_CHROME_ACCESS_TOKEN') {\n    const promise = new Promise((resolve, reject) => {\n      console.log('[Background] Getting Chrome extension access token for direct API access');\n\n      const manifest = chrome.runtime.getManifest();\n      const scopes = manifest.oauth2.scopes;\n\n      console.log('[Background] Requesting access token with scopes:', scopes);\n\n      try {\n        console.log('[Background] Requesting Chrome identity token with scopes:', scopes);\n        chrome.identity.getAuthToken({\n          interactive: true,\n          scopes: scopes\n        }, (token) => {\n          console.log('[Background] Chrome identity callback received');\n          console.log('[Background] Token received:', token ? 'YES (' + token.length + ' chars)' : 'NO');\n\n          if (chrome.runtime.lastError) {\n            console.error('[Background] Access token error:', chrome.runtime.lastError.message);\n            console.error('[Background] Full runtime error:', chrome.runtime.lastError);\n            reject(new Error(chrome.runtime.lastError.message));\n            return;\n          }\n\n          if (token) {\n            console.log('[Background] Access token obtained, fetching user info...');\n            \n            // Get user email using the access token\n            console.log('[Background] Fetching user info from Google API...');\n            fetch('https://www.googleapis.com/oauth2/v2/userinfo', {\n              headers: {\n                'Authorization': `Bearer ${token}`\n              }\n            })\n            .then(response => {\n              console.log('[Background] Userinfo API response status:', response.status);\n              console.log('[Background] Userinfo API response ok:', response.ok);\n\n              if (!response.ok) {\n                console.error('[Background] Userinfo API error response:', response.status, response.statusText);\n                return response.text().then(text => {\n                  console.error('[Background] Userinfo API error body:', text);\n                  throw new Error(`HTTP ${response.status}: ${text}`);\n                });\n              }\n\n              return response.json();\n            })\n            .then(userInfo => {\n              console.log('[Background] User info obtained successfully:', userInfo);\n              console.log('[Background] User email:', userInfo.email);\n              resolve({\n                accessToken: token,\n                userEmail: userInfo.email,\n                userInfo: userInfo\n              });\n            })\n            .catch(error => {\n              console.error('[Background] Detailed error fetching user info:', {\n                message: error.message,\n                stack: error.stack,\n                tokenLength: token ? token.length : 0,\n                tokenPrefix: token ? token.substring(0, 10) + '...' : 'null'\n              });\n\n              resolve({\n                accessToken: token,\n                userEmail: null,\n                error: 'Could not fetch user info: ' + error.message,\n                debug: {\n                  tokenLength: token ? token.length : 0,\n                  tokenPrefix: token ? token.substring(0, 10) : null,\n                  scopes: scopes,\n                  errorType: error.name,\n                  errorMessage: error.message\n                }\n              });\n            });\n          } else {\n            console.log('[Background] Access token request cancelled by user.');\n            reject(new Error('Access token request cancelled by user.'));\n          }\n        });\n      } catch (error) {\n        console.error('[Background] Error in getAuthToken:', error);\n        reject(error);\n      }\n    });\n\n    promise.then(sendResponse).catch(error => sendResponse({ error: error.message }));\n    return true; // Indicates an async response\n  }\n\n  // --- Message Handler 6: Clear Chrome Identity Cache (for sign-up only) ---\n  if (message.type === 'CLEAR_CHROME_IDENTITY_CACHE') {\n    const promise = new Promise((resolve, reject) => {\n      console.log('[Background] Clearing Chrome identity cache for fresh sign-up...');\n      \n      chrome.identity.clearAllCachedAuthTokens(() => {\n        if (chrome.runtime.lastError) {\n          console.log('[Background] Could not clear cached tokens (non-critical):', chrome.runtime.lastError.message);\n          resolve({ success: false, error: chrome.runtime.lastError.message });\n        } else {\n          console.log('[Background] Cached auth tokens cleared successfully');\n          resolve({ success: true });\n        }\n      });\n    });\n\n    promise.then(sendResponse).catch(error => sendResponse({ error: error.message }));\n    return true; // Indicates an async response\n  }\n\n  // --- Message Handler 4: Inject Floating Chat Scripts ---\n  if (message.type === 'INJECT_FLOATING_CHAT_SCRIPTS') {\n    (async () => {\n      try {\n        console.log('[Background] Handling INJECT_FLOATING_CHAT_SCRIPTS');\n        const [tab] = await chrome.tabs.query({active: true, lastFocusedWindow: true});\n        if (tab) {\n          await chrome.scripting.executeScript({\n            target: { tabId: tab.id },\n            files: [\n              'floating-chat/floating-chat.js',\n              'floating-chat/floating-chat-manager.js'\n            ]\n          });\n          console.log('[Background] Successfully injected floating chat scripts.');\n          sendResponse({ success: true });\n        } else {\n          throw new Error('No active tab found to inject scripts into.');\n        }\n      } catch (error) {\n        console.error('[Background] Failed to inject floating chat scripts:', error);\n        sendResponse({ success: false, error: error.message });\n      }\n    })();\n    return true; // Indicates an async response\n  }\n\n  // --- Message Handler 5: Get Installation State ---\n  if (message.type === 'GET_INSTALLATION_STATE') {\n    const promise = new Promise(async (resolve) => {\n      try {\n        const result = await chrome.storage.local.get(['installationId', 'userEmail']);\n        resolve({\n          isInstalled: !!result.installationId,\n          userEmail: result.userEmail || null,\n          installationId: result.installationId || null\n        });\n      } catch (error) {\n        console.error('[Background] Error getting installation state:', error);\n        resolve({ isInstalled: false, error: error.message });\n      }\n    });\n\n    promise.then(sendResponse);\n    return true;\n  }\n\n  // Log unhandled message types\n  console.warn('[Background] Unhandled message type:', message.type);\n  return false;\n}); \n\n// Clean up OAuth flows when tabs are closed\nchrome.tabs.onRemoved.addListener((tabId) => {\n  const flowState = webOAuthFlows.get(tabId);\n  if (flowState) {\n    console.log('[Background] OAuth tab closed, cleaning up flow:', tabId);\n    clearTimeout(flowState.timeout);\n    webOAuthFlows.delete(tabId);\n    flowState.reject(new Error('OAuth tab was closed'));\n  }\n});"],
  "mappings": "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",
  "names": []
}
